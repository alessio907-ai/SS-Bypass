# =====================================================
# MINECRAFT ANCHOR & CRYSTAL CHEAT DETECTOR
# =====================================================

$ErrorActionPreference = "SilentlyContinue"

# ---------------- UI DESIGN ----------------
function Show-Header {
    Clear-Host
    Write-Host ""
    Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor DarkRed
    Write-Host "â•‘" -NoNewline -ForegroundColor DarkRed
    Write-Host "        âš”ï¸  ANCHOR & CRYSTAL CHEAT DETECTOR         " -NoNewline -ForegroundColor Red
    Write-Host "â•‘" -ForegroundColor DarkRed
    Write-Host "â•‘" -NoNewline -ForegroundColor DarkRed
    Write-Host "       Speziell fÃ¼r CrystalPVP & Anchor Cheats       " -NoNewline -ForegroundColor Yellow
    Write-Host "â•‘" -ForegroundColor DarkRed
    Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor DarkRed
    Write-Host ""
}

function Show-Section($title) {
    Write-Host ""
    Write-Host "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" -ForegroundColor DarkCyan
    Write-Host "â”‚ $title" -ForegroundColor Cyan
    Write-Host "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" -ForegroundColor DarkCyan
    Write-Host ""
}

# ---------------- ANCHOR & CRYSTAL SIGNATURE DATABASE ----------------
$anchorCrystalSignatures = @{
    # ANCHOR CHEATS
    "AnchorAura" = @{
        Patterns = @(
            "anchorAura",
            "autoAnchor",
            "anchorPlace",
            "breakAnchor",
            "anchorExploit",
            "anchorTimer",
            "anchorPredict",
            "anchorTarget"
        )
        Description = "Automatisches Platzieren/Brechen von Anchors"
        RiskLevel = "HIGH"
        Category = "Anchor Exploit"
    }
    
    "AnchorMacro" = @{
        Patterns = @(
            "anchorMacro",
            "doubleAnchor",
            "anchorCombo",
            "anchorSwitch",
            "anchorSpam",
            "fastAnchor"
        )
        Description = "Makro fÃ¼r Anchor-Kombinationen"
        RiskLevel = "MEDIUM"
        Category = "Anchor Automation"
    }
    
    "AnchorTweaks" = @{
        Patterns = @(
            "anchorTweak",
            "anchorDelay",
            "anchorRange",
            "anchorAngle",
            "anchorBypass",
            "anchorOptimize"
        )
        Description = "Modifikation der Anchor-Mechanik"
        RiskLevel = "HIGH"
        Category = "Anchor Modification"
    }
    
    # CRYSTAL CHEATS
    "CrystalAura" = @{
        Patterns = @(
            "crystalAura",
            "autoCrystal",
            "crystalPlace",
            "breakCrystal",
            "crystalPredict",
            "crystalTimer",
            "crystalTarget",
            "crystalRange"
        )
        Description = "Automatisches Platzieren/Brechen von Crystals"
        RiskLevel = "CRITICAL"
        Category = "Crystal Automation"
    }
    
    "AutoCrystal" = @{
        Patterns = @(
            "autoCrystal",
            "crystalBot",
            "crystalAssist",
            "smartCrystal",
            "crystalHelper",
            "crystalCalculator"
        )
        Description = "Automatische Crystal-Berechnung & AusfÃ¼hrung"
        RiskLevel = "CRITICAL"
        Category = "Crystal Bot"
    }
    
    "CrystalOptimizer" = @{
        Patterns = @(
            "crystalOptimize",
            "crystalSpeed",
            "crystalDelay",
            "crystalRotation",
            "perfectCrystal",
            "crystalPredict"
        )
        Description = "Optimierung der Crystal-Geschwindigkeit"
        RiskLevel = "HIGH"
        Category = "Crystal Enhancement"
    }
    
    # COMBINATION CHEATS
    "AnchorCrystalCombo" = @{
        Patterns = @(
            "anchorCrystal",
            "comboAura",
            "doubleCombo",
            "comboBot",
            "comboMacro",
            "anchorCrystalSwitch"
        )
        Description = "Kombination aus Anchor und Crystal Automatisierung"
        RiskLevel = "CRITICAL"
        Category = "Combo Automation"
    }
    
    "CrystalPredict" = @{
        Patterns = @(
            "crystalPredict",
            "predictPlace",
            "predictBreak",
            "futureCrystal",
            "predictionBot",
            "crystalCalculator"
        )
        Description = "Vorhersage von Crystal-Platzierungen"
        RiskLevel = "HIGH"
        Category = "Prediction"
    }
    
    # BYPASS METHODS
    "AntiAnchor" = @{
        Patterns = @(
            "antiAnchor",
            "anchorBypass",
            "ignoreAnchor",
            "anchorResist",
            "anchorImmunity"
        )
        Description = "Bypass von Anchor-Schaden"
        RiskLevel = "CRITICAL"
        Category = "Bypass"
    }
    
    "AntiCrystal" = @{
        Patterns = @(
            "antiCrystal",
            "crystalBypass",
            "crystalResist",
            "ignoreCrystal",
            "crystalImmunity"
        )
        Description = "Bypass von Crystal-Schaden"
        RiskLevel = "CRITICAL"
        Category = "Bypass"
    }
}

# ---------------- SCAN FUNCTIONS ----------------
function Scan-For-AnchorCrystal-Signatures {
    Show-Section "ğŸ” SCAN NACH ANCHOR & CRYSTAL CHEATS"
    
    Write-Host "  ğŸ“Š Lade Cheat-Signaturen..." -ForegroundColor White
    Write-Host "     â””â”€ Anchor Cheats: " -NoNewline -ForegroundColor DarkGray
    Write-Host ($anchorCrystalSignatures.Keys | Where-Object { $_ -match "Anchor" }).Count -ForegroundColor Yellow
    
    Write-Host "     â””â”€ Crystal Cheats: " -NoNewline -ForegroundColor DarkGray
    Write-Host ($anchorCrystalSignatures.Keys | Where-Object { $_ -match "Crystal" }).Count -ForegroundColor Yellow
    
    Write-Host "     â””â”€ Total Signaturen: " -NoNewline -ForegroundColor DarkGray
    Write-Host $anchorCrystalSignatures.Count -ForegroundColor White
    
    Write-Host ""
    
    # Finde Minecraft Ordner
    $minecraftPath = "$env:APPDATA\.minecraft"
    if (-not (Test-Path $minecraftPath)) {
        Write-Host "  âŒ Minecraft Ordner nicht gefunden!" -ForegroundColor Red
        return @()
    }
    
    Write-Host "  ğŸ“ Scanne Minecraft Ordner..." -ForegroundColor Cyan
    Write-Host "     â””â”€ Pfad: $minecraftPath" -ForegroundColor Gray
    
    $foundCheats = @()
    $scanPaths = @(
        "$minecraftPath\mods",
        "$minecraftPath\versions", 
        "$minecraftPath\libraries",
        "$minecraftPath\shaderpacks"
    )
    
    foreach ($path in $scanPaths) {
        if (Test-Path $path) {
            Write-Host ""
            Write-Host "     ğŸ” Scanne: $(Split-Path $path -Leaf)" -ForegroundColor DarkCyan
            
            # Scan JAR files
            $jarFiles = Get-ChildItem -Path $path -Filter "*.jar" -Recurse -ErrorAction SilentlyContinue
            
            $scannedCount = 0
            $foundInPath = 0
            
            foreach ($jarFile in $jarFiles) {
                $scannedCount++
                if ($scannedCount % 50 -eq 0) {
                    Write-Host "       ğŸ“Š Gescannt: $scannedCount Dateien" -ForegroundColor DarkGray
                }
                
                $jarFindings = Scan-Jar-For-Signatures $jarFile.FullName
                
                if ($jarFindings.Count -gt 0) {
                    $foundInPath++
                    foreach ($finding in $jarFindings) {
                        $foundCheats += $finding
                    }
                }
            }
            
            if ($foundInPath -gt 0) {
                Write-Host "       âš ï¸  Gefunden: $foundInPath verdÃ¤chtige Dateien" -ForegroundColor Yellow
            } else {
                Write-Host "       âœ… Keine Cheats gefunden" -ForegroundColor Green
            }
        }
    }
    
    return $foundCheats
}

function Scan-Jar-For-Signatures($jarPath) {
    $jarFindings = @()
    $tempDir = Join-Path $env:TEMP ("mcscan_" + [guid]::NewGuid())
    
    try {
        # Extract JAR
        Add-Type -AssemblyName System.IO.Compression.FileSystem
        [System.IO.Compression.ZipFile]::ExtractToDirectory($jarPath, $tempDir)
        
        # Scan all files in JAR
        $allFiles = Get-ChildItem -Path $tempDir -Recurse -File -ErrorAction SilentlyContinue
        
        foreach ($file in $allFiles) {
            # Only scan certain file types
            if ($file.Extension -match "\.(class|java|txt|json|yml|yaml|properties|cfg)$") {
                try {
                    $content = Get-Content $file.FullName -Raw -ErrorAction Stop
                    $contentLower = $content.ToLower()
                    
                    # Check against all signatures
                    foreach ($cheatName in $anchorCrystalSignatures.Keys) {
                        $cheatInfo = $anchorCrystalSignatures[$cheatName]
                        
                        foreach ($pattern in $cheatInfo.Patterns) {
                            if ($contentLower -match $pattern.ToLower()) {
                                # Found a match!
                                $jarFindings += [PSCustomObject]@{
                                    CheatName = $cheatName
                                    FileName = $file.Name
                                    JarPath = $jarPath
                                    FullPath = $file.FullName
                                    Pattern = $pattern
                                    Description = $cheatInfo.Description
                                    RiskLevel = $cheatInfo.RiskLevel
                                    Category = $cheatInfo.Category
                                    Context = Extract-Context $content $pattern
                                }
                                break
                            }
                        }
                    }
                } catch {
                    # Could not read file, skip
                    continue
                }
            }
        }
        
    } catch {
        # Extraction failed
    } finally {
        # Cleanup
        if (Test-Path $tempDir) {
            Remove-Item -Path $tempDir -Recurse -Force -ErrorAction SilentlyContinue
        }
    }
    
    return $jarFindings
}

function Extract-Context($content, $pattern) {
    # Extract 50 chars before and after the match
    $index = $content.ToLower().IndexOf($pattern.ToLower())
    
    if ($index -ne -1) {
        $start = [math]::Max(0, $index - 50)
        $end = [math]::Min($content.Length, $index + $pattern.Length + 50)
        
        $context = $content.Substring($start, $end - $start)
        $context = $context -replace "[\r\n\t]", " "
        $context = $context.Trim()
        
        if ($context.Length -gt 100) {
            $context = $context.Substring(0, 97) + "..."
        }
        
        return $context
    }
    
    return "Context not available"
}

# ---------------- MEMORY SCAN FÃœR AKTIVE CHEATS ----------------
function Scan-Memory-For-Active-Cheats {
    Show-Section "ğŸ§  AKTIVE CHEATS IM SPEICHER SCANNEN"
    
    $javaProcesses = Get-Process | Where-Object { $_.ProcessName -match "java|javaw" }
    
    if ($javaProcesses.Count -eq 0) {
        Write-Host "  â„¹ï¸ Keine Java-Prozesse gefunden" -ForegroundColor Yellow
        return @()
    }
    
    Write-Host "  ğŸ” Scanne $($javaProcesses.Count) Java-Prozesse..." -ForegroundColor White
    
    $activeFindings = @()
    
    foreach ($proc in $javaProcesses) {
        Write-Host ""
        Write-Host "    ğŸ® Prozess: " -NoNewline -ForegroundColor Cyan
        Write-Host "$($proc.ProcessName)" -NoNewline -ForegroundColor White
        Write-Host " (PID: " -NoNewline -ForegroundColor DarkGray
        Write-Host "$($proc.Id)" -ForegroundColor White
        Write-Host ")" -ForegroundColor DarkGray
        
        try {
            # Check loaded modules/DLLs
            $modules = $proc.Modules | Where-Object { $_.ModuleName -match "\.(dll|jar|class)$" }
            
            $cheatModules = @()
            
            foreach ($module in $modules) {
                $moduleName = $module.ModuleName.ToLower()
                $modulePath = $module.FileName.ToLower()
                
                # Check for Anchor/Crystal related modules
                foreach ($cheatName in $anchorCrystalSignatures.Keys) {
                    $cheatInfo = $anchorCrystalSignatures[$cheatName]
                    
                    foreach ($pattern in $cheatInfo.Patterns) {
                        $patternLower = $pattern.ToLower()
                        
                        if ($moduleName -match $patternLower -or $modulePath -match $patternLower) {
                            $cheatModules += [PSCustomObject]@{
                                ModuleName = $module.ModuleName
                                Path = $module.FileName
                                CheatName = $cheatName
                                Pattern = $pattern
                                RiskLevel = $cheatInfo.RiskLevel
                            }
                            break
                        }
                    }
                }
            }
            
            if ($cheatModules.Count -gt 0) {
                Write-Host "      ğŸ”¥ AKTIVE CHEATS GEFUNDEN!" -ForegroundColor Red
                
                foreach ($cheatModule in $cheatModules) {
                    Write-Host "        ğŸ”´ $($cheatModule.CheatName)" -ForegroundColor Red
                    Write-Host "          â””â”€ Module: $($cheatModule.ModuleName)" -ForegroundColor Yellow
                    Write-Host "          â””â”€ Pfad: $($cheatModule.Path)" -ForegroundColor Gray
                    Write-Host "          â””â”€ Risiko: $($cheatModule.RiskLevel)" -ForegroundColor $(
                        if ($cheatModule.RiskLevel -eq "CRITICAL") { "Red" } 
                        elseif ($cheatModule.RiskLevel -eq "HIGH") { "Yellow" }
                        else { "White" }
                    )
                    
                    $activeFindings += $cheatModule
                }
            } else {
                Write-Host "      âœ… Keine aktiven Cheats" -ForegroundColor Green
            }
            
        } catch {
            Write-Host "      âš ï¸  Zugriff verweigert" -ForegroundColor Yellow
        }
    }
    
    return $activeFindings
}

# ---------------- DETAILED REPORT ----------------
function Show-Detailed-Report($fileFindings, $memoryFindings) {
    Show-Section "ğŸ“‹ DETAILLIERTER CHEAT REPORT"
    
    $totalFindings = $fileFindings.Count + $memoryFindings.Count
    
    if ($totalFindings -eq 0) {
        Write-Host "  âœ… KEINE ANCHOR/CRYSTAL CHEATS GEFUNDEN!" -ForegroundColor Green
        Write-Host ""
        Write-Host "     Deine Minecraft Installation scheint sauber zu sein." -ForegroundColor Gray
        Write-Host "     Keine bekannten Anchor/Crystal Cheats erkannt." -ForegroundColor Gray
        return
    }
    
    # Statistik
    Write-Host "  ğŸ“Š SCAN STATISTIK:" -ForegroundColor Cyan
    
    $byCategory = $fileFindings | Group-Object Category
    $byRisk = $fileFindings | Group-Object RiskLevel
    
    Write-Host "     â””â”€ Total Funde: " -NoNewline -ForegroundColor DarkGray
    Write-Host "$totalFindings" -ForegroundColor White
    
    Write-Host "     â””â”€ Datei-Funde: " -NoNewline -ForegroundColor DarkGray
    Write-Host "$($fileFindings.Count)" -ForegroundColor White
    
    Write-Host "     â””â”€ Aktive Cheats: " -NoNewline -ForegroundColor DarkGray
    Write-Host "$($memoryFindings.Count)" -ForegroundColor $(if ($memoryFindings.Count -gt 0) { "Red" } else { "White" })
    
    Write-Host ""
    
    # Gruppierte Anzeige
    if ($fileFindings.Count -gt 0) {
        Write-Host "  ğŸ“ GEFUNDENE CHEAT DATEIEN:" -ForegroundColor Yellow
        
        $groupedFiles = $fileFindings | Group-Object CheatName | Sort-Object Count -Descending
        
        foreach ($group in $groupedFiles) {
            $cheatInfo = $anchorCrystalSignatures[$group.Name]
            $riskColor = if ($cheatInfo.RiskLevel -eq "CRITICAL") { "Red" } 
                        elseif ($cheatInfo.RiskLevel -eq "HIGH") { "Yellow" } 
                        else { "White" }
            
            Write-Host ""
            Write-Host "    âš”ï¸ $($group.Name)" -ForegroundColor $riskColor
            Write-Host "      â””â”€ Beschreibung: $($cheatInfo.Description)" -ForegroundColor Gray
            Write-Host "      â””â”€ Kategorie: $($cheatInfo.Category)" -ForegroundColor Gray
            Write-Host "      â””â”€ Risiko: $($cheatInfo.RiskLevel)" -ForegroundColor $riskColor
            Write-Host "      â””â”€ Funde: $($group.Count) Dateien" -ForegroundColor White
            
            # Show example files
            $exampleFiles = $group.Group | Select-Object -First 3
            foreach ($file in $exampleFiles) {
                $fileName = Split-Path $file.JarPath -Leaf
                Write-Host "        ğŸ“„ $fileName" -ForegroundColor DarkGray
                Write-Host "          â””â”€ Pattern: $($file.Pattern)" -ForegroundColor DarkGray
                if ($file.Context) {
                    Write-Host "          â””â”€ Kontext: $($file.Context)" -ForegroundColor DarkGray
                }
            }
        }
    }
    
    if ($memoryFindings.Count -gt 0) {
        Write-Host ""
        Write-Host "  ğŸ”¥ AKTIV LAUFENDE CHEATS:" -ForegroundColor Red
        
        $groupedMemory = $memoryFindings | Group-Object CheatName
        
        foreach ($group in $groupedMemory) {
            $cheatInfo = $anchorCrystalSignatures[$group.Name]
            
            Write-Host ""
            Write-Host "    ğŸš¨ $($group.Name) - AKTIV!" -ForegroundColor Red
            Write-Host "      â””â”€ Prozesse: $($group.Count)" -ForegroundColor Yellow
            
            foreach ($finding in $group.Group) {
                Write-Host "        ğŸ“¦ $($finding.ModuleName)" -ForegroundColor Yellow
                Write-Host "          â””â”€ Pfad: $(Split-Path $finding.Path -Leaf)" -ForegroundColor Gray
            }
        }
        
        Write-Host ""
        Write-Host "  âš ï¸  WARNUNG: Aktive Cheats erkannt!" -ForegroundColor Red
        Write-Host "     Diese werden aktuell in Minecraft verwendet!" -ForegroundColor Yellow
    }
    
    # Recommendations
    Write-Host ""
    Show-Section "ğŸ”§ EMPFEHLUNGEN"
    
    if ($memoryFindings.Count -gt 0) {
        Write-Host "  ğŸ”´ SOFORTIGE AKTIONEN:" -ForegroundColor Red
        Write-Host "     1. ğŸ›‘ Minecraft sofort beenden" -ForegroundColor Yellow
        Write-Host "     2. ğŸ—‘ï¸ Gefundene Cheat-Dateien lÃ¶schen" -ForegroundColor Yellow
        Write-Host "     3. ğŸ”„ Computer neustarten" -ForegroundColor Yellow
        Write-Host "     4. ğŸ“ .minecraft/mods Ordner Ã¼berprÃ¼fen" -ForegroundColor Yellow
    }
    
    if ($fileFindings.Count -gt 0) {
        Write-Host ""
        Write-Host "  ğŸŸ¡ ALLGEMEINE EMPFEHLUNGEN:" -ForegroundColor Yellow
        Write-Host "     1. Nur vertrauenswÃ¼rdige Mods installieren" -ForegroundColor White
        Write-Host "     2. RegelmÃ¤ÃŸig auf Cheats scannen" -ForegroundColor White
        Write-Host "     3. VerdÃ¤chtige Mods entfernen" -ForegroundColor White
    }
}

# ---------------- MAIN EXECUTION ----------------
Show-Header

Write-Host "  ğŸ‘¤ Benutzer: " -NoNewline -ForegroundColor DarkGray
Write-Host "$env:USERNAME" -ForegroundColor White

Write-Host "  ğŸ® Minecraft: " -NoNewline -ForegroundColor DarkGray
Write-Host "$env:APPDATA\.minecraft" -ForegroundColor White

Write-Host "  ğŸ• Scanzeit: " -NoNewline -ForegroundColor DarkGray
Write-Host "$(Get-Date -Format 'HH:mm:ss')" -ForegroundColor White

Write-Host ""

# Scan for file-based cheats
$fileCheats = Scan-For-AnchorCrystal-Signatures

# Scan for active/memory cheats  
$activeCheats = Scan-Memory-For-Active-Cheats

# Show detailed report
Show-Detailed-Report $fileCheats $activeCheats

# ---------------- ACTION MENU ----------------
Write-Host ""
Show-Section "ğŸ“ AKTIONEN"

if (($fileCheats.Count + $activeCheats.Count) -gt 0) {
    Write-Host "  1. ğŸ—‘ï¸ Cheat-Dateien lÃ¶schen" -ForegroundColor Cyan
    Write-Host "  2. ğŸ›‘ Minecraft Prozesse beenden" -ForegroundColor Cyan
    Write-Host "  3. ğŸ” Nochmal scannen" -ForegroundColor Cyan
    Write-Host "  4. ğŸ’¾ Report speichern" -ForegroundColor Cyan
    Write-Host "  5. ğŸšª Beenden" -ForegroundColor Cyan
} else {
    Write-Host "  1. ğŸ” Scan wiederholen" -ForegroundColor Cyan
    Write-Host "  2. ğŸ“Š Detaillierte Systemanalyse" -ForegroundColor Cyan
    Write-Host "  3. ğŸšª Beenden" -ForegroundColor Cyan
}

$choice = Read-Host "`n  Auswahl"

switch ($choice) {
    "1" {
        if (($fileCheats.Count + $activeCheats.Count) -gt 0) {
            # Delete found cheats
            $deleted = 0
            foreach ($cheat in $fileCheats) {
                if (Test-Path $cheat.JarPath) {
                    try {
                        Remove-Item $cheat.JarPath -Force -ErrorAction Stop
                        Write-Host "  âœ… GelÃ¶scht: $(Split-Path $cheat.JarPath -Leaf)" -ForegroundColor Green
                        $deleted++
                    } catch {
                        Write-Host "  âŒ Fehler: $($cheat.JarPath)" -ForegroundColor Red
                    }
                }
            }
            
            Write-Host ""
            Write-Host "  ğŸ“Š $deleted Dateien gelÃ¶scht" -ForegroundColor White
        } else {
            # Rescan
            Write-Host "  ğŸ”„ Starte Scan neu..." -ForegroundColor Yellow
            Start-Sleep -Seconds 2
            & $PSCommandPath
        }
        
        Read-Host "`n  DrÃ¼cke Enter"
        & $PSCommandPath
    }
    "2" {
        if (($fileCheats.Count + $activeCheats.Count) -gt 0) {
            # Stop Minecraft processes
            $javaProcs = Get-Process | Where-Object { $_.ProcessName -match "java|javaw" }
            
            foreach ($proc in $javaProcs) {
                try {
                    Stop-Process -Id $proc.Id -Force
                    Write-Host "  âœ… Beendet: $($proc.ProcessName) (PID: $($proc.Id))" -ForegroundColor Green
                } catch {
                    Write-Host "  âŒ Fehler: $($proc.ProcessName)" -ForegroundColor Red
                }
            }
        } else {
            # Detailed system analysis
            Write-Host "  ğŸ“Š Starte detaillierte Systemanalyse..." -ForegroundColor Yellow
            # Hier kÃ¶nntest du weitere Scans einfÃ¼gen
        }
        
        Read-Host "`n  DrÃ¼cke Enter"
        & $PSCommandPath
    }
    "3" {
        Write-Host "  ğŸ”„ Starte Scan neu..." -ForegroundColor Yellow
        Start-Sleep -Seconds 2
        & $PSCommandPath
    }
    "4" {
        # Save report
        $reportPath = "$env:USERPROFILE\Desktop\AnchorCrystal_Scan_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"
        
        $report = @"
ANCHOR & CRYSTAL CHEAT SCAN REPORT
==================================
Datum: $(Get-Date -Format 'dd.MM.yyyy HH:mm:ss')
Benutzer: $env:USERNAME

SCAN ERGEBNISSE:
Datei-Cheats: $($fileCheats.Count)
Aktive Cheats: $($activeCheats.Count)

"@
        
        if ($fileCheats.Count -gt 0) {
            $report += "`nGEFUNDENE CHEAT DATEIEN:`n"
            foreach ($cheat in $fileCheats | Group-Object CheatName) {
                $cheatInfo = $anchorCrystalSignatures[$cheat.Name]
                $report += "`n- $($cheat.Name) ($($cheat.Count)x)`n"
                $report += "  Beschreibung: $($cheatInfo.Description)`n"
                $report += "  Risiko: $($cheatInfo.RiskLevel)`n"
                $report += "  Dateien:`n"
                foreach ($file in $cheat.Group | Select-Object -First 5) {
                    $report += "    â€¢ $($file.JarPath)`n"
                }
            }
        }
        
        $report | Out-File -FilePath $reportPath -Encoding UTF8
        Write-Host "  ğŸ’¾ Report gespeichert: $reportPath" -ForegroundColor Green
        
        Read-Host "`n  DrÃ¼cke Enter"
        & $PSCommandPath
    }
    "5" {
        Write-Host "  ğŸ‘‹ Beende..." -ForegroundColor Yellow
        Exit
    }
    default {
        & $PSCommandPath
    }
}
